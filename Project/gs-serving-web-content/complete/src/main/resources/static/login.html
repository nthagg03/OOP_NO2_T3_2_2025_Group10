<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Coffee Shop - Đăng nhập</title>
    <style>
        :root{--coffee-900:#3e2723;--accent:#c59d5f}
        *{box-sizing:border-box;font-family:system-ui,-apple-system,'Segoe UI',Roboto,Helvetica,Arial,sans-serif}
        body{margin:0;min-height:100vh;display:grid;place-items:center;padding:40px 20px;background:linear-gradient(180deg,#f3ece9,#ffffff 35%);color:var(--coffee-900)}
        .shell{width:100%;max-width:480px;background:#fff;border:1px solid rgba(62,39,35,.08);border-radius:20px;padding:36px;display:flex;flex-direction:column;gap:22px;box-shadow:0 12px 30px -12px rgba(62,39,35,.25)}
        .brand-row{display:flex;align-items:center;gap:12px}
        .logo{width:56px;height:56px;display:grid;place-items:center;border-radius:12px;background:rgba(0,0,0,.04);font-size:26px}
        h1{margin:0;font-size:22px}
        .subtitle{margin:0;color:#6b5850}
        form{display:grid;gap:16px}
        .field{display:grid;gap:6px}
        label{font-size:13px;font-weight:600;color:#6a524a}
        .input-wrap{position:relative}
        input{width:100%;padding:12px 14px;border:1px solid rgba(62,39,35,.16);border-radius:12px;font-size:15px}
        .row{display:flex;justify-content:space-between;align-items:center}
        .checkbox{display:inline-flex;align-items:center;gap:8px}
        .btn{border:0;cursor:pointer;padding:12px 18px;font-weight:700;border-radius:16px;background:linear-gradient(135deg,var(--accent),#e4bd7d);color:#352418}
        .alert{font-size:13px;padding:10px 12px;border-radius:12px;border:1px solid;display:flex;gap:8px;align-items:flex-start}
        .alert.error{background:#fff4f4;border-color:#f6c9c9;color:#b00020}
        .alert.success{background:#f0faf1;border-color:#bfe3c4;color:#2e7d32}
        .bottom-note{text-align:center;color:#6f5a53}
        .bottom-note a{color:var(--coffee-900);text-decoration:none;font-weight:600}
    </style>
</head>
<body>
<div class="shell">
    <div class="brand-row">
        <div class="logo">☕</div>
        <div>
            <h1>Coffee Shop</h1>
            <p class="subtitle">Đăng nhập hệ thống</p>
        </div>
    </div>

    <form id="loginForm" action="#" method="post" autocomplete="on">
        <div class="field">
            <label for="email">Email / Tên đăng nhập</label>
            <div class="input-wrap">
                <input id="email" name="email" type="text" required autofocus autocomplete="username" />
            </div>
        </div>

        <div class="field">
            <label for="password">Mật khẩu</label>
            <div class="input-wrap">
                <input id="password" name="password" type="password" required autocomplete="current-password" />
            </div>
        </div>

        <div class="row">
            <label class="checkbox"><input type="checkbox" name="remember-me" /> Ghi nhớ</label>
            <a href="#" onclick="alert('Liên hệ quản trị để đặt lại mật khẩu');return false;">Quên mật khẩu?</a>
        </div>

        <button class="btn" type="submit">Đăng nhập</button>

        <div id="alertError" class="alert error" style="display:none"><strong>✖</strong> Sai thông tin đăng nhập. Vui lòng thử lại.</div>
        <div id="alertLogout" class="alert success" style="display:none"><strong>✔</strong> Bạn đã đăng xuất thành công.</div>
    </form>

    <div class="bottom-note">Chưa có tài khoản? <a href="register.html">Đăng ký ngay</a></div>

    <script>
        (function(){
            const form = document.getElementById('loginForm');
            const alertError = document.getElementById('alertError');
            const alertLogout = document.getElementById('alertLogout');
            try{
                const params = new URLSearchParams(window.location.search);
                if(params.get('logout') === '1') alertLogout.style.display = 'flex';
            }catch(e){}
            form.addEventListener('submit', function(ev){
                ev.preventDefault();
                alertError.style.display = 'none';
                const email = form.email.value.trim();
                const password = form.password.value.trim();
                if(!email || !password){ alertError.style.display = 'flex'; return; }
                    // Validate against users stored in localStorage
                    try{
                        const raw = localStorage.getItem('users');
                        const users = raw ? JSON.parse(raw) : [];
                        const match = users.find(u => (u.email === email || u.username === email) && u.password === password);
                        if(match){
                            // set a simple session marker
                            sessionStorage.setItem('currentUser', JSON.stringify({id: match.id || null, email: match.email, username: match.username}));
                            window.location.href = 'dashboard.html';
                            return;
                        }
                    }catch(e){
                        console.error(e);
                    }

                    alertError.style.display = 'flex';
            });
        })();
    </script>
</div>
</body>
</html>